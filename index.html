<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ata Operacional Porter - 2026</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="styles.css">
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-database-compat.js"></script>
    
    <script>
        // Configura√ß√£o do Firebase
        (function() {
            try {
                const firebaseConfig = {
                    apiKey: "AIzaSyCqYN7aqNo_HXVHRSTY6b9qRDMSlPCrMNg",
                    authDomain: "ataporter-8a06a.firebaseapp.com",
                    projectId: "ataporter-8a06a",
                    storageBucket: "ataporter-8a06a.firebasestorage.app",
                    messagingSenderId: "1046205675591",
                    appId: "1:1046205675591:web:4731578a5d102c563e1962"
                };

                // Verifica se j√° foi inicializado
                if (!firebase.apps.length) {
                    firebase.initializeApp(firebaseConfig);
                    console.log('üî• Firebase inicializado com sucesso!');
                } else {
                    console.log('‚ö†Ô∏è Firebase j√° estava inicializado');
                }
                
                // Inicializa servi√ßos
                window.db = firebase.firestore();
                window.auth = firebase.auth();
                window.rtdb = firebase.database();
                
                // Configura Firestore para n√£o dar erro de persist√™ncia
                window.db.settings({
                    cacheSizeBytes: firebase.firestore.CACHE_SIZE_UNLIMITED
                });
                
                console.log('‚úÖ Servi√ßos Firebase dispon√≠veis globalmente');
            } catch (error) {
                console.error('‚ùå Erro ao inicializar Firebase:', error);
            }
        })();
    </script>
</head>
<body>
    <!-- Toast Container -->
    <div id="toast-container" class="toast-container"></div>

    <!-- TELA DE LOGIN -->
    <section id="login-screen">
        <div class="login-container">
            <div class="login-logo">
                <div class="login-logo-img"></div>
                <h1>Ata Operacional Porter</h1>
                <p>Sistema de Registro de Ocorr√™ncias - 2026</p>
            </div>
            <div class="form-group input-icon">
                <i class="fas fa-user"></i>
                <input type="text" id="login-user" placeholder="nome.sobrenome" autocomplete="off">
            </div>
            <div class="form-group input-icon">
                <i class="fas fa-lock"></i>
                <input type="password" id="login-pass" placeholder="********" autocomplete="off">
            </div>
            <div class="form-group input-icon">
                <i class="fas fa-clock"></i>
                <select id="login-turno">
                    <option value="Diurno">Diurno</option>
                    <option value="Noturno">Noturno</option>
                </select>
            </div>
            <button class="btn btn-primary" id="login-button">
                <i class="fas fa-sign-in-alt"></i> ACESSAR SISTEMA
            </button>
            <div style="margin-top: 1.5rem; text-align: center; font-size: 0.8rem; color: var(--gray);">
                <i class="fas fa-info-circle"></i> Use suas credenciais fornecidas pela Porter
            </div>
        </div>
    </section>

    <!-- SIDEBAR -->
    <div id="sidebar">
        <div class="sidebar-header">
            <h3><i class="fas fa-building"></i> CONDOM√çNIOS</h3>
            <button class="sidebar-toggle" onclick="app.toggleSidebar()">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div class="condo-list" id="condo-list"></div>
    </div>

    <!-- CONTE√öDO PRINCIPAL -->
    <div id="main-content" class="hidden">
        <header>
            <div class="header-left">
                <button class="mobile-toggle" onclick="app.toggleSidebar()">
                    <i class="fas fa-bars"></i>
                </button>
                <div class="header-logo">
                    <div class="logo-porter"></div>
                    <div class="header-logo-text">
                        <strong>ATA OPERACIONAL PORTER</strong>
                        <div>Sistema de Registro de Ocorr√™ncias - 2026</div>
                    </div>
                </div>
            </div>
            
            <div id="user-info"></div>
            
            <div style="display: flex; align-items: center; gap: 15px;">
                <!-- Theme Toggle -->
                <div id="theme-toggle" class="theme-toggle">
                    <i class="fas fa-sun active"></i>
                    <i class="fas fa-moon"></i>
                </div>

                <!-- OPERADORES ONLINE -->
                <div id="online-users" class="online-users-dropdown">
                    <i class="fas fa-users"></i>
                    <span style="font-size: 0.9rem;">
                        <span id="online-count">0</span> online
                    </span>
                    <i class="fas fa-chevron-down" style="font-size: 0.8rem;"></i>
                    <div id="online-users-list" class="online-users-list"></div>
                </div>

                <!-- Notifica√ß√µes -->
                <div class="notification-bell" onclick="app.toggleNotifications()">
                    <i class="fas fa-bell"></i>
                    <span class="notification-badge" id="notification-count">0</span>
                    <div class="notifications-panel" id="notifications-panel">
                        <div class="notification-header">
                            <strong><i class="fas fa-bell"></i> Notifica√ß√µes</strong>
                            <button class="btn btn-clear btn-sm" onclick="app.clearNotifications()">Limpar</button>
                        </div>
                        <div id="notifications-list"></div>
                    </div>
                </div>

                <!-- Bot√£o Relat√≥rio -->
                <button class="btn btn-success" onclick="app.openReportModal()">
                    <i class="fas fa-file-pdf"></i> Relat√≥rio
                </button>

                <!-- Bot√£o Admin -->
                <div id="admin-controls" class="admin-controls" style="display: none;">
                    <button class="btn btn-warning" onclick="app.openAdminPanel()">
                        <i class="fas fa-user-shield"></i> Admin
                    </button>
                </div>

                <!-- Bot√£o Sair -->
                <button class="btn btn-accent" onclick="app.logout()">
                    <i class="fas fa-sign-out-alt"></i> Sair
                </button>
            </div>
        </header>

        <div class="tabs">
            <button class="tab-btn active" onclick="app.switchTab('tab-ata', this)">
                <i class="fas fa-file-alt"></i> ATA DE OCORR√äNCIAS
                <span class="tab-badge" id="tab-count-ata">0</span>
            </button>
            <button class="tab-btn" onclick="app.switchTab('tab-fixas', this)">
                <i class="fas fa-thumbtack"></i> INFORMA√á√ïES FIXAS
                <span class="tab-badge" id="tab-count-fixas">0</span>
            </button>
            <button class="tab-btn" onclick="app.switchTab('tab-os', this)">
                <i class="fas fa-tools"></i> ORDEM DE SERVI√áO
                <span class="tab-badge" id="tab-count-os">0</span>
            </button>
            <button class="tab-btn chat-tab" onclick="app.switchTab('tab-chat', this)">
                <i class="fas fa-comments"></i> CHAT GERAL
                <span class="chat-badge" id="chat-badge">0</span>
            </button>
            <button class="tab-btn" onclick="app.switchTab('tab-chat-privado', this)">
                <i class="fas fa-user-secret"></i> CHAT PRIVADO
                <span class="chat-badge" id="chat-private-badge">0</span>
            </button>
            <button class="tab-btn" onclick="app.switchTab('tab-presenca', this)">
                <i class="fas fa-users"></i> HIST√ìRICO
            </button>
        </div>

        <div class="container">
            <!-- Componente de Humor -->
            <div id="mood-check-container" class="mood-check-container hidden">
                <div class="mood-title">
                    <i class="fas fa-heart"></i> Como voc√™ est√° se sentindo hoje?
                </div>
                <div class="mood-subtitle">
                    Selecione a express√£o que melhor representa seu estado emocional atual
                </div>
                <div class="mood-options" id="mood-options"></div>
                <div class="mood-status" id="mood-status">
                    <i class="fas fa-mouse-pointer"></i> Clique em uma express√£o para selecionar
                </div>
                <div class="mood-submit">
                    <button class="btn btn-primary" onclick="app.enviarMood()" id="mood-submit-btn" disabled>
                        <i class="fas fa-paper-plane"></i> Enviar Meu Sentimento
                    </button>
                </div>
                <div id="mood-result" class="mood-result hidden"></div>
            </div>

            <!-- ABA: ATA -->
            <div id="tab-ata" class="tab-content">
                <div class="filters-container">
                    <div class="filters-title">
                        <i class="fas fa-filter"></i> Filtrar Registros
                    </div>
                    <div class="grid-3">
                        <div class="form-group">
                            <label><i class="fas fa-building"></i> Condom√≠nio</label>
                            <select id="filter-condo">
                                <option value="">Todos os condom√≠nios</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label><i class="fas fa-calendar"></i> Data Inicial</label>
                            <input type="date" id="filter-data-inicio">
                        </div>
                        <div class="form-group">
                            <label><i class="fas fa-calendar"></i> Data Final</label>
                            <input type="date" id="filter-data-fim">
                        </div>
                        <div class="form-group">
                            <label><i class="fas fa-tag"></i> Tipo</label>
                            <select id="filter-tipo">
                                <option value="">Todos os tipos</option>
                                <option value="Informa√ß√£o">üìù Informa√ß√£o</option>
                                <option value="Ocorr√™ncia">‚ö†Ô∏è Ocorr√™ncia</option>
                                <option value="Incidente">üö® Incidente</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label><i class="fas fa-tasks"></i> Status</label>
                            <select id="filter-status">
                                <option value="">Todos os status</option>
                                <option value="Em andamento">üîÑ Em andamento</option>
                                <option value="Finalizado">‚úÖ Finalizado</option>
                            </select>
                        </div>
                        <div class="filter-actions">
                            <button class="btn btn-filter" onclick="app.aplicarFiltrosAtas()">
                                <i class="fas fa-search"></i> Filtrar
                            </button>
                            <button class="btn btn-clear" onclick="app.limparFiltrosAtas()">
                                <i class="fas fa-times"></i> Limpar
                            </button>
                        </div>
                    </div>
                    <div id="filtros-ativos-ata" class="filter-info"></div>
                </div>

                <div id="resultados-info-ata" style="margin-bottom: 1rem;"></div>

                <div class="form-card fade-in">
                    <h2><i class="fas fa-plus-circle"></i> Novo Registro de Ocorr√™ncia</h2>
                    <div class="grid-2">
                        <div class="form-group">
                            <label><i class="fas fa-building"></i> Condom√≠nio</label>
                            <select id="ata-condo" onchange="app.updateCity()">
                                <option value="">Selecione um condom√≠nio...</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label><i class="fas fa-city"></i> Cidade</label>
                            <input type="text" id="ata-cidade" readonly>
                        </div>
                    </div>
                    <div class="grid-2">
                        <div class="form-group">
                            <label><i class="fas fa-tag"></i> Tipo de Registro</label>
                            <select id="ata-tipo">
                                <option value="Informa√ß√£o">üìù Informa√ß√£o</option>
                                <option value="Ocorr√™ncia">‚ö†Ô∏è Ocorr√™ncia</option>
                                <option value="Incidente">üö® Incidente</option>
                                <option value="Informa√ß√µes Fixas">üìå Informa√ß√µes Fixas</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label><i class="fas fa-tasks"></i> Status</label>
                            <select id="ata-status">
                                <option value="Em andamento">üîÑ Em andamento</option>
                                <option value="Finalizado">‚úÖ Finalizado</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label><i class="fas fa-align-left"></i> Descri√ß√£o dos Fatos</label>
                        <textarea id="ata-desc" rows="5" placeholder="Descreva detalhadamente os fatos ocorridos..."></textarea>
                    </div>
                    <button class="btn btn-primary" onclick="app.saveAta()">
                        <i class="fas fa-save"></i> SALVAR REGISTRO
                    </button>
                </div>

                <div id="ata-lista"></div>
            </div>

            <!-- ABA: INFORMA√á√ïES FIXAS -->
            <div id="tab-fixas" class="tab-content hidden">
                <div class="fixed-info-container">
                    <div class="fixed-info-header">
                        <i class="fas fa-thumbtack"></i>
                        <h3>Informa√ß√µes Fixas dos Condom√≠nios</h3>
                    </div>
                    <p style="color: var(--warning); margin-bottom: 1rem;">
                        <i class="fas fa-info-circle"></i> Estas s√£o informa√ß√µes importantes que permanecem vis√≠veis para todos os operadores.
                    </p>
                </div>
                <div id="fixas-lista"></div>
            </div>

            <!-- ABA: ORDEM DE SERVI√áO -->
            <div id="tab-os" class="tab-content hidden">
                <div id="os-confirmation-screen" class="os-confirmation hidden">
                    <i class="fas fa-check-circle"></i>
                    <h2>Ordem de Servi√ßo Aberta com Sucesso!</h2>
                    <p style="font-size: 1.1rem; color: var(--gray); margin-bottom: 2rem;">
                        A sua ordem de servi√ßo foi registrada e enviada por e-mail.
                    </p>
                    <div class="details">
                        <div><strong>üìã N√∫mero da OS:</strong> <span id="os-confirmation-id"></span></div>
                        <div><strong>üè¢ Condom√≠nio:</strong> <span id="os-confirmation-condo"></span></div>
                        <div><strong>‚ö†Ô∏è Gravidade:</strong> <span id="os-confirmation-gravidade"></span></div>
                        <div><strong>üë§ Funcion√°rio:</strong> <span id="os-confirmation-funcionario"></span></div>
                        <div><strong>üìß E-mail:</strong> <span id="os-confirmation-email"></span></div>
                        <div><strong>üìÖ Data/Hora:</strong> <span id="os-confirmation-data"></span></div>
                    </div>
                    <p style="margin-top: 1.5rem; color: var(--gray); font-size: 0.9rem;">
                        <i class="fas fa-info-circle"></i>
                        Um e-mail foi enviado para a equipe t√©cnica com todos os detalhes.
                    </p>
                    <div class="back-to-os">
                        <button class="btn btn-primary" onclick="appEmail.voltarParaFormOS()">
                            <i class="fas fa-plus-circle"></i> Abrir Nova OS
                        </button>
                    </div>
                </div>

                <div id="os-form-container">
                    <div class="form-card os-form fade-in">
                        <h2><i class="fas fa-tools"></i> Nova Ordem de Servi√ßo</h2>
                        <form id="os-form-email" action="https://formsubmit.co/londrina.operacional@porter.com.br" method="POST">
                            <input type="hidden" name="_cc" value="londrina.tecnicaplantao@porter.com.br,londrina.tenicaplantao1@porter.com.br,londrina.tecnica1@porter.com.br">
                            <input type="hidden" name="_subject" value="[NOVA O.S] - Sistema Porter">
                            <input type="hidden" name="_template" value="table">
                            <input type="hidden" name="_captcha" value="false">
                            <input type="hidden" name="_next" value="#os-confirmation-screen">
                            
                            <div class="grid-2">
                                <div class="form-group">
                                    <label><i class="fas fa-building"></i> Condom√≠nio *</label>
                                    <select id="os-condo" name="condominio" onchange="app.updateCityOS()" required>
                                        <option value="">Selecione um condom√≠nio...</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label><i class="fas fa-city"></i> Cidade</label>
                                    <input type="text" id="os-cidade" name="cidade" readonly>
                                </div>
                            </div>
                            <div class="grid-2">
                                <div class="form-group">
                                    <label><i class="fas fa-user"></i> Nome do Funcion√°rio *</label>
                                    <input type="text" id="os-funcionario" name="funcionario" placeholder="Seu nome completo" required>
                                </div>
                                <div class="form-group">
                                    <label><i class="fas fa-envelope"></i> E-mail do Funcion√°rio *</label>
                                    <input type="email" id="os-email" name="email" placeholder="seu.email@porter.com.br" required>
                                </div>
                            </div>
                            <div class="grid-2">
                                <div class="form-group">
                                    <label><i class="fas fa-sitemap"></i> Setor/Departamento *</label>
                                    <select id="os-setor" name="setor" required>
                                        <option value="">Selecione o setor...</option>
                                        <option value="Opera√ß√£o">Opera√ß√£o</option>
                                        <option value="Administrativo">Administrativo</option>
                                        <option value="T√©cnico">T√©cnico</option>
                                        <option value="RH">Recursos Humanos</option>
                                        <option value="Financeiro">Financeiro</option>
                                        <option value="Comercial">Comercial</option>
                                        <option value="Outro">Outro</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label><i class="fas fa-exclamation-triangle"></i> Gravidade da Ocorr√™ncia *</label>
                                    <select id="os-gravidade" name="gravidade" required>
                                        <option value="Baixa">üü¢ Baixa - Manuten√ß√£o Preventiva/Rotina</option>
                                        <option value="M√©dia" selected>üü° M√©dia - Reparo Necess√°rio</option>
                                        <option value="Alta">üî¥ Alta - Urgente/Problema Cr√≠tico</option>
                                        <option value="Emerg√™ncia">üö® Emerg√™ncia - Risco Imediato</option>
                                    </select>
                                </div>
                            </div>
                            <div class="form-group">
                                <label><i class="fas fa-user-cog"></i> T√©cnico respons√°vel</label>
                                <select id="os-tecnico" name="tecnico_responsavel">
                                    <option value="">Selecione um t√©cnico (opcional)</option>
                                    <optgroup label="T√âCNICOS LONDRINA">
                                        <option value="EVERTON ALAN - T√âCNICO PORTER">EVERTON ALAN - T√âCNICO PORTER</option>
                                        <option value="MARCIO JOSE DE BARROS - TEC PORTER">MARCIO JOSE DE BARROS - TEC PORTER</option>
                                        <option value="VALDEIR COITO - T√âCNICO PORTER">VALDEIR COITO - T√âCNICO PORTER</option>
                                    </optgroup>
                                    <optgroup label="AUXILIARES">
                                        <option value="WELINGTON SANTOS - AUXILIAR T√âCNICO">WELINGTON SANTOS - AUXILIAR T√âCNICO</option>
                                        <option value="CLEBERSON SILVA - AUXILIAR T√âCNICO T√ÅTICO PORTER">CLEBERSON SILVA - AUXILIAR T√âCNICO T√ÅTICO PORTER</option>
                                        <option value="EMANOEL THOMAZ - AUXILIAR T√âCNICO">EMANOEL THOMAZ - AUXILIAR T√âCNICO</option>
                                    </optgroup>
                                    <optgroup label="T√âCNICOS MARING√Å">
                                        <option value="VINICIUS MENDES - PORTER MARING√Å">VINICIUS MENDES - PORTER MARING√Å</option>
                                        <option value="ITALO - T√âCNICO PORTER">ITALO - T√âCNICO PORTER</option>
                                    </optgroup>
                                </select>
                            </div>
                            <div class="form-group">
                                <label><i class="fas fa-align-left"></i> Descri√ß√£o do Problema *</label>
                                <textarea id="os-desc" name="descricao" rows="5" placeholder="Descreva detalhadamente o problema ou servi√ßo necess√°rio..." required></textarea>
                            </div>
                            <div class="form-group">
                                <label><i class="fas fa-calendar"></i> Data Preferencial para Atendimento</label>
                                <input type="date" id="os-data" name="data_preferencial">
                            </div>
                            <button type="submit" class="btn btn-info" onclick="app.abrirOSComEmail(event)">
                                <i class="fas fa-paper-plane"></i> ABRIR ORDEM DE SERVI√áO
                            </button>
                        </form>
                    </div>

                    <div style="margin: 2rem 0 1rem 0; display: flex; justify-content: space-between; align-items: center;">
                        <h3><i class="fas fa-list"></i> Ordens de Servi√ßo Recentes</h3>
                        <div style="display: flex; gap: 10px;">
                            <div class="btn-group">
                                <button class="btn btn-filter" onclick="app.filtrarOSTodas()">Todas</button>
                                <button class="btn btn-filter" onclick="app.filtrarOSGravidade('Alta')">üî¥ Alta</button>
                                <button class="btn btn-filter" onclick="app.filtrarOSGravidade('M√©dia')">üü° M√©dia</button>
                                <button class="btn btn-filter" onclick="app.filtrarOSGravidade('Baixa')">üü¢ Baixa</button>
                            </div>
                        </div>
                    </div>
                    <div id="os-lista"></div>
                </div>
            </div>

            <!-- ABA: CHAT GERAL -->
            <div id="tab-chat" class="tab-content hidden">
                <div class="chat-container">
                    <div class="chat-header">
                        <div>
                            <strong><i class="fas fa-comments"></i> Chat Geral dos Operadores</strong>
                            <div style="font-size: 0.85rem; opacity: 0.9;">Comunica√ß√£o r√°pida entre a equipe</div>
                        </div>
                        <div class="chat-admin-controls" id="chat-admin-controls" style="display: none;">
                            <button class="chat-clear-btn" onclick="chatSystem.clearChat()">
                                <i class="fas fa-trash"></i> Limpar Chat
                            </button>
                        </div>
                    </div>
                    <div class="chat-messages" id="chat-messages"></div>
                    <div class="chat-input-area">
                        <textarea class="chat-input" id="chat-input" placeholder="Digite sua mensagem..." rows="2"></textarea>
                        <button class="btn btn-info" onclick="chatSystem.sendChatMessage()" id="chat-send-btn">
                            <i class="fas fa-paper-plane"></i> Enviar
                        </button>
                    </div>
                </div>
            </div>

            <!-- ABA: CHAT PRIVADO -->
            <div id="tab-chat-privado" class="tab-content hidden">
                <div class="chat-container chat-private-container">
                    <div class="chat-header chat-private-header">
                        <div>
                            <strong><i class="fas fa-user-secret"></i> Chat Privado</strong>
                            <div style="font-size: 0.85rem; opacity: 0.9;">Conversa privada entre operadores</div>
                        </div>
                    </div>
                    
                    <div class="private-chat-selector">
                        <div class="form-group">
                            <label><i class="fas fa-user-friends"></i> Conversar com:</label>
                            <select id="private-chat-target" onchange="chatSystem.loadPrivateChat()">
                                <option value="">Selecione um operador...</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="chat-messages chat-private-messages" id="chat-private-messages"></div>
                    
                    <div class="chat-input-area">
                        <textarea class="chat-input" id="chat-private-input" placeholder="Digite sua mensagem privada..." rows="2" disabled></textarea>
                        <button class="btn btn-info" onclick="chatSystem.sendPrivateChatMessage()" id="chat-private-send-btn" disabled>
                            <i class="fas fa-paper-plane"></i> Enviar
                        </button>
                    </div>
                </div>
            </div>

            <!-- ABA: HIST√ìRICO -->
            <div id="tab-presenca" class="tab-content hidden">
                <div class="filters-container">
                    <div class="filters-title">
                        <i class="fas fa-filter"></i> Filtrar Hist√≥rico
                    </div>
                    <div class="grid-3">
                        <div class="form-group">
                            <label><i class="fas fa-user"></i> Operador</label>
                            <select id="filter-presenca-operador">
                                <option value="">Todos os operadores</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label><i class="fas fa-calendar"></i> Data Inicial</label>
                            <input type="date" id="filter-presenca-inicio">
                        </div>
                        <div class="form-group">
                            <label><i class="fas fa-calendar"></i> Data Final</label>
                            <input type="date" id="filter-presenca-fim">
                        </div>
                        <div class="form-group">
                            <label><i class="fas fa-clock"></i> Turno</label>
                            <select id="filter-presenca-turno">
                                <option value="">Todos os turnos</option>
                                <option value="Diurno">üåû Diurno</option>
                                <option value="Noturno">üåô Noturno</option>
                            </select>
                        </div>
                        <div class="filter-actions">
                            <button class="btn btn-filter" onclick="app.aplicarFiltrosPresenca()">
                                <i class="fas fa-search"></i> Filtrar
                            </button>
                            <button class="btn btn-clear" onclick="app.limparFiltrosPresenca()">
                                <i class="fas fa-times"></i> Limpar
                            </button>
                        </div>
                    </div>
                </div>

                <h3 style="margin: 2rem 0 1rem 0;"><i class="fas fa-history"></i> Hist√≥rico de Acesso</h3>
                <div style="overflow-x: auto;">
                    <table>
                        <thead>
                            <tr>
                                <th><i class="fas fa-user"></i> Operador</th>
                                <th><i class="fas fa-clock"></i> Turno</th>
                                <th><i class="fas fa-calendar"></i> Data</th>
                                <th><i class="fas fa-sign-in-alt"></i> Login</th>
                                <th><i class="fas fa-sign-out-alt"></i> Logoff</th>
                            </tr>
                        </thead>
                        <tbody id="presenca-lista"></tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- MODAIS -->
    <div class="modal" id="report-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-file-pdf"></i> Gerar Relat√≥rio PDF</h3>
                <button class="modal-close" onclick="app.closeReportModal()">&times;</button>
            </div>
            <div class="form-group">
                <label><i class="fas fa-building"></i> Condom√≠nio</label>
                <select id="report-condo">
                    <option value="">Todos os condom√≠nios</option>
                </select>
            </div>
            <div class="grid-2">
                <div class="form-group">
                    <label><i class="fas fa-calendar"></i> Data Inicial</label>
                    <input type="date" id="report-data-inicio">
                </div>
                <div class="form-group">
                    <label><i class="fas fa-calendar"></i> Data Final</label>
                    <input type="date" id="report-data-fim">
                </div>
            </div>
            <div class="form-group">
                <label><i class="fas fa-tag"></i> Tipo de Conte√∫do</label>
                <select id="report-tipo">
                    <option value="atas">üìã Ocorr√™ncias</option>
                    <option value="fixas">üìå Informa√ß√µes Fixas</option>
                    <option value="os">üîß Ordens de Servi√ßo</option>
                    <option value="all">üìä Todos os Registros</option>
                </select>
            </div>
            <div class="pdf-preview" id="pdf-preview">
                <div class="pdf-icon">
                    <i class="fas fa-file-pdf"></i>
                </div>
                <p>Selecione as op√ß√µes e gere o relat√≥rio</p>
            </div>
            <div style="display: flex; gap: 10px; margin-top: 1.5rem;">
                <button class="btn btn-primary" onclick="pdfGenerator.generatePDF()">
                    <i class="fas fa-download"></i> Gerar PDF
                </button>
                <button class="btn btn-clear" onclick="app.closeReportModal()">Cancelar</button>
            </div>
        </div>
    </div>

    <div class="modal" id="comments-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-comments"></i> Coment√°rios</h3>
                <button class="modal-close" onclick="app.closeCommentsModal()">&times;</button>
            </div>
            <div id="comments-modal-content"></div>
        </div>
    </div>

    <div class="modal" id="admin-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-user-shield"></i> Controle Administrativo</h3>
                <button class="modal-close" onclick="app.closeAdminModal()">&times;</button>
            </div>
            <div id="admin-modal-content"></div>
        </div>
    </div>

    <!-- SCRIPTS -->
    <!-- Firebase j√° foi carregado e inicializado no head -->
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

    <script src="data.js"></script>
    <script src="firebase.js"></script>
    <script src="app.js"></script>
    <script src="app-email.js"></script>
    <script src="chat.js"></script>
    <script src="pdf.js"></script>
    <script src="utils.js"></script>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üöÄ Sistema iniciando...');
            console.log('Firebase dispon√≠vel:', typeof firebase !== 'undefined');
            console.log('db dispon√≠vel:', typeof window.db !== 'undefined');
            
            if (typeof app !== 'undefined' && app.init) {
                app.init();
            }

            const loginButton = document.getElementById('login-button');
            if (loginButton) {
                loginButton.addEventListener('click', function() {
                    if (app && typeof app.login === 'function') {
                        app.login();
                    }
                });
            }

            const loginPass = document.getElementById('login-pass');
            if (loginPass) {
                loginPass.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter' && app && typeof app.login === 'function') {
                        app.login();
                    }
                });
            }

            // Theme toggle
            const themeToggle = document.getElementById('theme-toggle');
            if (themeToggle) {
                themeToggle.addEventListener('click', () => {
                    if (app && typeof app.toggleTheme === 'function') {
                        app.toggleTheme();
                    }
                });
            }
        });
    </script>
</body>
</html>
