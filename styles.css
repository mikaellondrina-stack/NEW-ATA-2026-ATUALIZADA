<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Porter - Portal de Comunicação</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <!-- Tela de Login -->
    <div id="login-screen">
        <div class="login-container">
            <div class="login-logo">
                <div class="login-logo-img"></div>
                <h1>Portal Porter</h1>
                <p>Gestão de Comunicação para Condomínios</p>
            </div>
            
            <div class="form-group">
                <label for="login-email"><i class="fas fa-envelope"></i> E-mail</label>
                <input type="email" id="login-email" class="form-control" placeholder="seu@email.com" autocomplete="username">
            </div>
            
            <div class="form-group">
                <label for="login-password"><i class="fas fa-lock"></i> Senha</label>
                <input type="password" id="login-password" class="form-control" placeholder="••••••••" autocomplete="current-password">
            </div>
            
            <div class="form-group">
                <label for="login-condominio"><i class="fas fa-building"></i> Condomínio</label>
                <select id="login-condominio" class="form-control">
                    <option value="">Selecione um condomínio</option>
                </select>
            </div>
            
            <button id="login-btn" class="btn btn-primary btn-block">
                <i class="fas fa-sign-in-alt"></i> Entrar
            </button>
            
            <div class="text-center mt-3">
                <a href="#" id="forgot-password" class="text-muted">Esqueci minha senha</a>
            </div>
            
            <div id="login-error" class="alert alert-danger mt-3" style="display: none;"></div>
        </div>
    </div>

    <!-- Sidebar -->
    <div id="sidebar">
        <div class="sidebar-header">
            <h3>Condomínios</h3>
            <button class="sidebar-toggle">
                <i class="fas fa-times"></i>
            </button>
        </div>
        
        <div class="condo-list">
            <!-- Lista de condomínios será preenchida via JavaScript -->
        </div>
    </div>

    <!-- Conteúdo Principal -->
    <div id="main-content">
        <!-- Header -->
        <header>
            <div class="header-left">
                <button class="mobile-toggle">
                    <i class="fas fa-bars"></i>
                </button>
                
                <div class="header-logo">
                    <div class="logo-porter"></div>
                    <div class="header-logo-text">
                        <strong id="current-condo-name">Portal Porter</strong>
                        <div>Gestão de Comunicação</div>
                    </div>
                </div>
            </div>
            
            <div class="header-right">
                <div class="online-users-dropdown" id="online-users-trigger">
                    <i class="fas fa-users"></i>
                    <span>Operadores Online: <span id="online-count">0</span></span>
                    <i class="fas fa-chevron-down"></i>
                    
                    <div class="online-users-list" id="online-users-list">
                        <!-- Lista de usuários online será preenchida via JavaScript -->
                    </div>
                </div>
                
                <div class="notification-bell" id="notification-bell">
                    <i class="fas fa-bell"></i>
                    <span class="notification-badge" id="notification-count">0</span>
                    
                    <div class="notifications-panel" id="notifications-panel">
                        <div class="notification-header">
                            <strong>Notificações</strong>
                            <button class="btn btn-sm btn-info" id="mark-all-read">
                                <i class="fas fa-check-double"></i> Marcar todas como lidas
                            </button>
                        </div>
                        <!-- Notificações serão preenchidas via JavaScript -->
                    </div>
                </div>
                
                <div id="user-info">
                    <div class="user-info-name">
                        <i class="fas fa-user"></i>
                        <span id="user-name">Usuário</span>
                    </div>
                    <div class="user-info-time">
                        <i class="fas fa-clock"></i>
                        <span id="login-time">--:--</span>
                    </div>
                    <div class="user-info-role" id="user-role">Operador</div>
                </div>
                
                <button id="logout-btn" class="btn btn-danger btn-sm">
                    <i class="fas fa-sign-out-alt"></i> Sair
                </button>
            </div>
        </header>

        <!-- Tabs -->
        <div class="tabs">
            <button class="tab-btn active" data-tab="dashboard">
                <i class="fas fa-home"></i> Dashboard
            </button>
            <button class="tab-btn" data-tab="atas">
                <i class="fas fa-file-alt"></i> ATAs
                <span class="tab-badge" id="ata-badge">0</span>
            </button>
            <button class="tab-btn" data-tab="chat">
                <i class="fas fa-comments"></i> Chat Geral
                <span class="chat-badge" id="chat-badge">0</span>
            </button>
            <button class="tab-btn" data-tab="os">
                <i class="fas fa-tools"></i> Ordem de Serviço
                <span class="tab-badge" id="os-badge">0</span>
            </button>
            <button class="tab-btn" data-tab="fixas">
                <i class="fas fa-info-circle"></i> Informações Fixas
            </button>
            <button class="tab-btn" data-tab="admin">
                <i class="fas fa-cog"></i> Administração
            </button>
            <button class="tab-btn" data-tab="email">
                <i class="fas fa-envelope"></i> Enviar E-mail
            </button>
        </div>

        <!-- Container Principal -->
        <div class="container">
            <!-- Dashboard -->
            <div id="dashboard" class="tab-content visible">
                <div class="mood-check-container">
                    <h2 class="mood-title">
                        <i class="fas fa-smile"></i> Como está seu humor hoje?
                    </h2>
                    <p class="mood-subtitle">Selecione abaixo para registrar seu estado atual</p>
                    
                    <div class="mood-options">
                        <div class="mood-option" data-mood="excelente" data-color="#27ae60">
                            <div class="mood-face">
                                <i class="fas fa-laugh-beam" style="color: #27ae60; font-size: 2.5rem;"></i>
                            </div>
                            <div class="mood-label">Excelente</div>
                            <div class="mood-description">Ótimo dia!</div>
                        </div>
                        
                        <div class="mood-option" data-mood="bom" data-color="#2ecc71">
                            <div class="mood-face">
                                <i class="fas fa-smile" style="color: #2ecc71; font-size: 2.5rem;"></i>
                            </div>
                            <div class="mood-label">Bom</div>
                            <div class="mood-description">Tudo fluindo bem</div>
                        </div>
                        
                        <div class="mood-option" data-mood="normal" data-color="#f39c12">
                            <div class="mood-face">
                                <i class="fas fa-meh" style="color: #f39c12; font-size: 2.5rem;"></i>
                            </div>
                            <div class="mood-label">Normal</div>
                            <div class="mood-description">Dia comum</div>
                        </div>
                        
                        <div class="mood-option" data-mood="ruim" data-color="#e74c3c">
                            <div class="mood-face">
                                <i class="fas fa-frown" style="color: #e74c3c; font-size: 2.5rem;"></i>
                            </div>
                            <div class="mood-label">Ruim</div>
                            <div class="mood-description">Não está fácil</div>
                        </div>
                        
                        <div class="mood-option" data-mood="pessimo" data-color="#c0392b">
                            <div class="mood-face">
                                <i class="fas fa-dizzy" style="color: #c0392b; font-size: 2.5rem;"></i>
                            </div>
                            <div class="mood-label">Péssimo</div>
                            <div class="mood-description">Dia difícil</div>
                        </div>
                    </div>
                    
                    <div class="mood-status" id="mood-status">
                        Nenhum humor selecionado
                    </div>
                    
                    <button id="submit-mood" class="btn btn-accent mood-submit" disabled>
                        <i class="fas fa-paper-plane"></i> Registrar Humor
                    </button>
                    
                    <div id="mood-result" class="mood-result hidden">
                        <i class="fas fa-check-circle"></i>
                        <span>Humor registrado com sucesso!</span>
                    </div>
                </div>
                
                <div class="row">
                    <div class="col-md-6">
                        <div class="card">
                            <div class="card-header bg-primary text-white">
                                <h5 class="mb-0"><i class="fas fa-chart-line"></i> Estatísticas do Dia</h5>
                            </div>
                            <div class="card-body">
                                <div class="row text-center">
                                    <div class="col-4">
                                        <h3 id="stats-atas">0</h3>
                                        <small>ATAs</small>
                                    </div>
                                    <div class="col-4">
                                        <h3 id="stats-chat">0</h3>
                                        <small>Mensagens</small>
                                    </div>
                                    <div class="col-4">
                                        <h3 id="stats-os">0</h3>
                                        <small>O.S.</small>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-md-6">
                        <div class="card">
                            <div class="card-header bg-info text-white">
                                <h5 class="mb-0"><i class="fas fa-user-clock"></i> Online Agora</h5>
                            </div>
                            <div class="card-body">
                                <div id="dashboard-online-list">
                                    <!-- Lista de online no dashboard -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ATAs -->
            <div id="atas" class="tab-content hidden">
                <div class="filters-container">
                    <h3 class="filters-title">
                        <i class="fas fa-filter"></i> Filtros de ATAs
                    </h3>
                    
                    <div class="grid-3">
                        <div class="form-group">
                            <label for="filter-status">Status</label>
                            <select id="filter-status" class="form-control">
                                <option value="">Todos</option>
                                <option value="pendente">Pendente</option>
                                <option value="andamento">Em Andamento</option>
                                <option value="concluido">Concluído</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="filter-tipo">Tipo</label>
                            <select id="filter-tipo" class="form-control">
                                <option value="">Todos</option>
                                <option value="reuniao">Reunião</option>
                                <option value="ocorrencia">Ocorrência</option>
                                <option value="manutencao">Manutenção</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="filter-data">Data</label>
                            <input type="date" id="filter-data" class="form-control">
                        </div>
                    </div>
                    
                    <div class="filter-actions">
                        <button id="apply-filters" class="btn btn-filter">
                            <i class="fas fa-search"></i> Aplicar Filtros
                        </button>
                        <button id="clear-filters" class="btn btn-clear">
                            <i class="fas fa-times"></i> Limpar Filtros
                        </button>
                        <button id="new-ata-btn" class="btn btn-accent">
                            <i class="fas fa-plus"></i> Nova ATA
                        </button>
                    </div>
                </div>
                
                <div class="active-filters" id="active-filters" style="display: none;">
                    Filtros ativos: <span id="filters-text"></span>
                </div>
                
                <div id="atas-list">
                    <!-- ATAs serão carregadas aqui -->
                    <div class="no-results">
                        <i class="fas fa-file-alt fa-3x mb-3"></i>
                        <h4>Nenhuma ATA encontrada</h4>
                        <p>Use os filtros acima ou crie uma nova ATA</p>
                    </div>
                </div>
                
                <!-- Modal Nova ATA -->
                <div id="ata-modal" class="modal">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h4><i class="fas fa-file-alt"></i> Nova ATA</h4>
                            <button class="modal-close">&times;</button>
                        </div>
                        
                        <div class="modal-body">
                            <div class="form-group">
                                <label for="ata-title">Título *</label>
                                <input type="text" id="ata-title" class="form-control" placeholder="Digite o título da ATA">
                            </div>
                            
                            <div class="form-group">
                                <label for="ata-desc">Descrição *</label>
                                <textarea id="ata-desc" class="form-control" rows="4" placeholder="Descreva os detalhes da ATA"></textarea>
                            </div>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="ata-tipo">Tipo *</label>
                                    <select id="ata-tipo" class="form-control">
                                        <option value="reuniao">Reunião</option>
                                        <option value="ocorrencia">Ocorrência</option>
                                        <option value="manutencao">Manutenção</option>
                                        <option value="outro">Outro</option>
                                    </select>
                                </div>
                                
                                <div class="form-group">
                                    <label for="ata-priority">Prioridade</label>
                                    <select id="ata-priority" class="form-control">
                                        <option value="baixa">Baixa</option>
                                        <option value="media">Média</option>
                                        <option value="alta">Alta</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label for="ata-responsavel">Responsável</label>
                                <input type="text" id="ata-responsavel" class="form-control" placeholder="Nome do responsável">
                            </div>
                            
                            <div class="form-group">
                                <label for="ata-deadline">Prazo</label>
                                <input type="date" id="ata-deadline" class="form-control">
                            </div>
                        </div>
                        
                        <div class="modal-footer">
                            <button id="cancel-ata" class="btn btn-clear">Cancelar</button>
                            <button id="save-ata" class="btn btn-primary">Salvar ATA</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Chat Geral -->
            <div id="chat" class="tab-content hidden">
                <div class="chat-container">
                    <div class="chat-header">
                        <div>
                            <h4><i class="fas fa-comments"></i> Chat Geral</h4>
                            <small id="chat-room-info">Sala: Geral</small>
                        </div>
                        <div class="chat-admin-controls">
                            <button id="clear-chat" class="btn btn-danger btn-sm">
                                <i class="fas fa-trash"></i> Limpar Chat
                            </button>
                            <button id="toggle-auto-scroll" class="btn btn-info btn-sm">
                                <i class="fas fa-arrow-down"></i> Auto-scroll
                            </button>
                        </div>
                    </div>
                    
                    <div class="chat-messages" id="chat-messages">
                        <!-- Mensagens serão carregadas aqui -->
                        <div class="empty-state">
                            <i class="fas fa-comments fa-3x mb-3"></i>
                            <h4>Nenhuma mensagem ainda</h4>
                            <p>Seja o primeiro a enviar uma mensagem!</p>
                        </div>
                    </div>
                    
                    <div class="chat-input-area">
                        <textarea class="chat-input" id="chat-input" placeholder="Digite sua mensagem..." rows="1"></textarea>
                        <button id="send-chat" class="btn btn-primary">
                            <i class="fas fa-paper-plane"></i> Enviar
                        </button>
                    </div>
                </div>
            </div>

            <!-- Ordem de Serviço -->
            <div id="os" class="tab-content hidden">
                <div class="form-card os-form">
                    <h2><i class="fas fa-tools"></i> Nova Ordem de Serviço</h2>
                    
                    <div class="form-group">
                        <label for="os-title">Título do Serviço *</label>
                        <input type="text" id="os-title" class="form-control" placeholder="Ex: Reparo na porta do elevador">
                    </div>
                    
                    <div class="form-group">
                        <label for="os-desc">Descrição Detalhada *</label>
                        <textarea id="os-desc" class="form-control" rows="5" placeholder="Descreva o problema ou serviço necessário"></textarea>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="os-local">Local do Serviço *</label>
                            <input type="text" id="os-local" class="form-control" placeholder="Ex: Torre A, 10º andar">
                        </div>
                        
                        <div class="form-group">
                            <label for="os-priority">Prioridade *</label>
                            <select id="os-priority" class="form-control">
                                <option value="baixa">Baixa (até 7 dias)</option>
                                <option value="media">Média (até 3 dias)</option>
                                <option value="alta">Alta (até 24h)</option>
                                <option value="urgente">Urgente (imediato)</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="os-fornecedor">Fornecedor/Responsável</label>
                            <input type="text" id="os-fornecedor" class="form-control" placeholder="Nome do fornecedor">
                        </div>
                        
                        <div class="form-group">
                            <label for="os-contact">Contato</label>
                            <input type="text" id="os-contact" class="form-control" placeholder="Telefone ou e-mail">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="os-estimate">Orçamento Estimado (R$)</label>
                        <input type="number" id="os-estimate" class="form-control" placeholder="0,00" step="0.01">
                    </div>
                    
                    <div class="form-group">
                        <label for="os-observations">Observações Adicionais</label>
                        <textarea id="os-observations" class="form-control" rows="3" placeholder="Informações complementares"></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label>Anexos</label>
                        <div class="pdf-preview" id="os-preview">
                            <i class="fas fa-file-pdf pdf-icon"></i>
                            <p>Nenhum arquivo selecionado</p>
                            <input type="file" id="os-file" accept=".pdf,.jpg,.jpeg,.png" hidden>
                            <button id="os-upload-btn" class="btn btn-info btn-sm">
                                <i class="fas fa-upload"></i> Selecionar Arquivo
                            </button>
                        </div>
                    </div>
                    
                    <div class="text-end">
                        <button id="cancel-os" class="btn btn-clear">Cancelar</button>
                        <button id="submit-os" class="btn btn-primary">
                            <i class="fas fa-paper-plane"></i> Enviar Ordem de Serviço
                        </button>
                    </div>
                </div>
                
                <div id="os-list">
                    <!-- Lista de OS será carregada aqui -->
                    <div class="no-results">
                        <i class="fas fa-tools fa-3x mb-3"></i>
                        <h4>Nenhuma Ordem de Serviço</h4>
                        <p>Preencha o formulário acima para criar uma nova OS</p>
                    </div>
                </div>
            </div>

            <!-- Informações Fixas -->
            <div id="fixas" class="tab-content hidden">
                <div class="fixed-info-container">
                    <div class="fixed-info-header">
                        <i class="fas fa-info-circle fa-2x"></i>
                        <h3>Informações Fixas do Condomínio</h3>
                    </div>
                    
                    <div class="form-group">
                        <label for="fixed-contato">Contato Administrativo</label>
                        <textarea id="fixed-contato" class="form-control" rows="3" placeholder="Informações de contato do síndico e administradora"></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="fixed-regras">Regras do Condomínio</label>
                        <textarea id="fixed-regras" class="form-control" rows="5" placeholder="Regras importantes do condomínio"></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="fixed-horarios">Horários e Funcionamento</label>
                        <textarea id="fixed-horarios" class="form-control" rows="4" placeholder="Horários de áreas comuns, portaria, etc."></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="fixed-emergencia">Contatos de Emergência</label>
                        <textarea id="fixed-emergencia" class="form-control" rows="3" placeholder="Bombeiros, polícia, ambulância, etc."></textarea>
                    </div>
                    
                    <div class="text-end">
                        <button id="save-fixed" class="btn btn-primary">
                            <i class="fas fa-save"></i> Salvar Informações
                        </button>
                    </div>
                </div>
            </div>

            <!-- Administração -->
            <div id="admin" class="tab-content hidden">
                <div class="card">
                    <div class="card-header bg-warning text-dark">
                        <h5 class="mb-0"><i class="fas fa-cog"></i> Controles Administrativos</h5>
                    </div>
                    <div class="card-body">
                        <div class="admin-controls">
                            <button id="backup-btn" class="btn btn-info">
                                <i class="fas fa-database"></i> Backup de Dados
                            </button>
                            <button id="export-data" class="btn btn-success">
                                <i class="fas fa-file-export"></i> Exportar Relatórios
                            </button>
                            <button id="force-logoff" class="btn btn-danger">
                                <i class="fas fa-user-slash"></i> Forçar Logoff de Todos
                            </button>
                            <button id="clear-all-data" class="btn btn-danger">
                                <i class="fas fa-trash"></i> Limpar Todos os Dados
                            </button>
                        </div>
                        
                        <hr>
                        
                        <div class="form-group">
                            <label for="admin-message">Mensagem Administrativa Global</label>
                            <textarea id="admin-message" class="form-control" rows="3" placeholder="Digite uma mensagem para todos os usuários"></textarea>
                            <button id="send-admin-msg" class="btn btn-warning mt-2">
                                <i class="fas fa-bullhorn"></i> Enviar Mensagem Global
                            </button>
                        </div>
                        
                        <hr>
                        
                        <h5><i class="fas fa-users-cog"></i> Gerenciamento de Usuários</h5>
                        <div id="users-list">
                            <!-- Lista de usuários será carregada aqui -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- Enviar E-mail -->
            <div id="email" class="tab-content hidden">
                <div class="form-card">
                    <h2><i class="fas fa-envelope"></i> Enviar E-mail</h2>
                    
                    <div class="email-form-container">
                        <div class="form-group">
                            <label for="email-to">Para *</label>
                            <select id="email-to" class="form-control" multiple>
                                <option value="moradores">Todos os Moradores</option>
                                <option value="sindico">Síndico</option>
                                <option value="zelador">Zelador</option>
                                <option value="portaria">Portaria</option>
                                <option value="administradora">Administradora</option>
                            </select>
                            <small class="text-muted">Selecione um ou mais destinatários</small>
                        </div>
                        
                        <div class="form-group">
                            <label for="email-subject">Assunto *</label>
                            <input type="text" id="email-subject" class="form-control" placeholder="Assunto do e-mail">
                        </div>
                        
                        <div class="form-group">
                            <label for="email-body">Mensagem *</label>
                            <textarea id="email-body" class="form-control" rows="10" placeholder="Digite sua mensagem..."></textarea>
                        </div>
                        
                        <div class="form-group">
                            <label for="email-attachment">Anexos</label>
                            <input type="file" id="email-attachment" class="form-control">
                            <small class="text-muted">Formatos aceitos: PDF, JPG, PNG (máx. 5MB)</small>
                        </div>
                        
                        <div class="captcha-container">
                            <div class="captcha-question" id="captcha-question">
                                Quanto é 5 + 3?
                            </div>
                            <input type="text" class="form-control captcha-input" id="captcha-answer" placeholder="Resposta">
                        </div>
                    </div>
                    
                    <div class="email-status" id="email-status"></div>
                    
                    <div class="text-end mt-3">
                        <button id="cancel-email" class="btn btn-clear">Cancelar</button>
                        <button id="send-email" class="btn btn-primary">
                            <i class="fas fa-paper-plane"></i> Enviar E-mail
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de Email -->
    <div id="email-modal" class="modal">
        <div class="modal-content email-modal-content">
            <div class="modal-header">
                <h4><i class="fas fa-envelope"></i> Enviar E-mail</h4>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <!-- Conteúdo do email será inserido aqui -->
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-storage-compat.js"></script>
    <script src="firebase.js"></script>
    <script src="app.js"></script>
    <script src="app-email.js"></script>
    
    <script>
        // Inicialização do sistema
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Sistema Porter inicializado');
        });
    </script>
</body>
</html>
